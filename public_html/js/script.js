function coordFind(){var e=document.getElementById("portals").value;var t=e.split(/\n/);var n=/(?:http(?:s{0,1}):\/\/www.ingress.com\/intel\?ll=)(?:-{0,1})?\d{1,3}(?:.)\d{1,6}(?:,)(?:-{0,1})\d{0,3}(?:(?:.)\d{1,6}){0,1}(?:&z=)\d{1,2}(?:&pll=)((?:-{0,1})?\d{1,3}(?:.{0,1})\d{1,6})(?:,)((?:-{0,1})\d{1,3}(?:.)\d{1,6})$/;waypts=[];for(var r=0;r<t.length;r++){if(!(t[r]=="")){if(!n.test(t[r])){errorMsg();errorMap();throw new Error("invalid")}n.exec(t[r]);var i=new google.maps.LatLng(RegExp.$1,RegExp.$2);waypts.push({location:i,stopover:true});map.setCenter(i);map.setZoom(15);successMsg()}}if(e===""){errorMsg();errorMap()}}function errorMsg(){document.getElementById("portalValid").className="glyphicon glyphicon-remove";document.getElementById("validDiv").className="form-group has-error";document.getElementById("mapBtn").className="btn btn-default btn-block";document.getElementById("mapBtn").disabled="disabled";document.getElementById("map").value=""}function successMsg(){document.getElementById("portalValid").className="glyphicon glyphicon-ok";document.getElementById("validDiv").className="form-group has-success";document.getElementById("mapBtn").className="btn btn-success btn-block";document.getElementById("mapBtn").disabled=""}function successMap(){document.getElementById("mapLink").className="btn btn-success";document.getElementById("mapLink").disabled=""}function errorMap(){document.getElementById("mapLink").disabled="disabled";document.getElementById("mapLink").className="btn btn-default"}function openMap(){var e=document.getElementById("map").value;if(e){var t=window.open(e,"_blank");if(t){t.focus()}else{alert("Please allow popups for this site.")}}}function dropSwap(){var e=document.getElementById("manual-drop");if(e.className=="fa fa-chevron-down"){e.className="fa fa-chevron-up"}else{e.className="fa fa-chevron-down"}}function initialize(){directionsDisplay=new google.maps.DirectionsRenderer;var e={zoom:2,center:new google.maps.LatLng(0,0)};map=new google.maps.Map(document.getElementById("map-canvas"),e);directionsDisplay.setMap(map)}function calcRoute(){coordFind();var e=waypts[0].location;var t=waypts[waypts.length-1].location;waypts.splice(0,1);waypts.splice(waypts.length-1,1);var n=document.getElementById("optimal").checked;var r={origin:e,destination:t,waypoints:waypts,optimizeWaypoints:n,travelMode:google.maps.TravelMode.DRIVING};directionsService.route(r,function(r,i){if(i==google.maps.DirectionsStatus.OK){directionsDisplay.setDirections(r);var s=r.routes[0].waypoint_order;var o=r.routes[0];var u="http://maps.google.com/maps/dir/"+e.toUrlValue()+"/";if(n&&s.length>0){for(var a=0;a<s.length;a++){var f=waypts[s[a]].location;f=f.toUrlValue();u=u+f+"/"}u+=t.toUrlValue()+"/";document.getElementById("map").value=u;successMap()}else{for(var a=0;a<waypts.length;a++){var f=waypts[a].location;f=f.toUrlValue();u=u+f+"/"}u=u+t.toUrlValue()+"/";document.getElementById("map").value=u;successMap()}}})}var map;var waypts=[];var directionsDisplay;var directionsService=new google.maps.DirectionsService;google.maps.event.addDomListener(window,"load",initialize)